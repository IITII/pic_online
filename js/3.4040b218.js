(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3],{"17bf":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-layout",{staticClass:"full-height-width",attrs:{view:"lhh lpr lfr"}},[n("pic-header"),n("q-drawer",{attrs:{"show-if-above":"",elevated:"","content-class":"bg-grey-1"},model:{value:e.leftDrawerSync,callback:function(t){e.leftDrawerSync=t},expression:"leftDrawerSync"}},[n("div",{staticClass:"q-pa-md q-gutter-sm"},[n("div",{staticStyle:{"text-align":"center"}},[n("q-badge",{attrs:{color:e.badge.color,"text-color":e.badge.text_color}},[e._v("\n          "+e._s(e.selectNodeTitle)+"\n        ")])],1),n("div",[n("q-input",{ref:"filter",attrs:{filled:"",label:e.$t("filter")},scopedSlots:e._u([{key:"append",fn:function(){return[""!==e.tree.filter?n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"clear"},on:{click:e.resetFilter}}):e._e()]},proxy:!0}]),model:{value:e.tree.filter,callback:function(t){e.$set(e.tree,"filter",t)},expression:"tree.filter"}})],1),n("div",[n("q-tree",{ref:"qtree",attrs:{nodes:e.tree.nodes,"node-key":"nodeKey",dark:e.tree.dark,filter:e.tree.filter,expanded:e.tree.expanded,selected:e.tree.selectedNodeSync},on:{"update:expanded":function(t){return e.$set(e.tree,"expanded",t)},"update:selected":[function(t){return e.$set(e.tree,"selectedNodeSync",t)},e.update_selected]},scopedSlots:e._u([{key:"header-root",fn:function(t){return[n("div",{staticClass:"row items-center"},[e._v("\n              "+e._s(t.node.label)+"\n              "),t.node.children.length>0?n("q-badge",{staticClass:"q-ml-sm",attrs:{color:e.badge.color,"text-color":e.badge.text_color}},[e._v("\n                "+e._s(t.node.children.length)+"\n              ")]):e._e()],1)]}}])})],1)])]),n("q-page-container",{staticClass:"full-height-width"},[n("router-view")],1)],1)},r=[],s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("q-header",{attrs:{elevated:"","show-if-above":""}},[n("q-toolbar",[n("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu"},on:{click:e.leftDrawer}}),n("q-toolbar-title",[e._v("\n        "+e._s(e.selectNodeTitle)+"\n      ")]),n("pic-language-picker")],1)],1)],1)},a=[],i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("q-select",{attrs:{options:e.langOptions,color:"pink",dark:!0,"options-dark":!1,"dropdown-icon":"translate",dense:"","options-dense":!1,borderless:"","emit-value":"","map-options":""},model:{value:e.lang,callback:function(t){e.lang=t},expression:"lang"}})],1)},l=[],d={name:"PicLanguagePicker",data(){return{langOptions:[{value:"en-us",label:"English"},{value:"zh-cn",label:"简体中文"}]}},computed:{lang:{get:function(){return this.$log.debug("Get language setting"),this.$store.getters["uiControl/language"]||this.$q.lang.getLocale()||"zh-cn"},set:function(e){this.$log.debug(`Set language to ${e}`),this.$i18n.locale=e,this.$store.dispatch("uiControl/setLanguage",e)}}},beforeMount(){this.$i18n.locale=this.lang}},c=d,u=n("2877"),h=n("ddd8"),f=n("eebe"),g=n.n(f),p=Object(u["a"])(c,i,l,!1,null,"ff0507a2",null),b=p.exports;g()(p,"components",{QSelect:h["a"]});var $={name:"PicHeader",components:{PicLanguagePicker:b},methods:{leftDrawer:function(){this.$store.dispatch("uiControl/reverseLeftDrawerOpen")}},computed:{selectNodeTitle:{get:function(){return this.$store.getters["uiControl/selectedNodeTitle"]}}}},v=$,x=n("e359"),y=n("65c6"),_=n("9c40"),m=n("6ac5"),w=Object(u["a"])(v,s,a,!1,null,"0abb5f7e",null),N=w.exports;g()(w,"components",{QHeader:x["a"],QToolbar:y["a"],QBtn:_["a"],QToolbarTitle:m["a"]});var k={name:"MainLayout",components:{PicHeader:N},data(){return{leftDrawerOpen:!1,tree:{filter:"",nodes:[],expanded:[],selectedNodeSync:"",dark:!1},badge:{color:"primary",text_color:"white"}}},computed:{leftDrawerSync:{get:function(){return this.$store.getters["uiControl/leftDrawerOpen"]},set:function(){return this.$store.dispatch("uiControl/reverseLeftDrawerOpen")}},selectNodeTitle:{get:function(){return this.$store.getters["uiControl/selectedNodeTitle"]},set:function(e){if(this.$log.debug(e),null!==e||""!==e)return this.$store.dispatch("uiControl/setSelectedNodeTitle",e)}}},methods:{updateExpandedNodeByNodesBfs:function(e,t=16){let n=[],o=[],r=[],s=[],a=0;n=n.concat(e);while(0!==n.length){const e=n.shift();if(s.push(e.nodeKey),void 0!==e.children){if(0!==e.children.length&&(o=o.concat(e.children),a+=e.children.length),r.length+a>=t){if(0===r.length)continue;break}r=r.concat(s),s=[]}0===n.length&&(n=n.concat(o),o=[])}return r},updateExpandedNodeByNodes:function(e,t){let n=[];return t<1?[]:(e.forEach((e=>{void 0!==e.nodeKey&&n.push(e.nodeKey),void 0!==e.children&&0!==e.children.length&&(n=n.concat(this.updateExpandedNodeByNodes(e.children,t-1)))})),n)},resetFilter:function(){this.tree.filter="",this.$refs.filter.focus()},expandNode:function(e){this.$log.debug(e)},beforeunloadFn:function(e){this.$log.debug(`before unload function ${e}`)},btn_click_nextNode:function(){const e=this.$store.getters["uiControl/nodeKey"];this.update_selected(e+1)},update_selected:function(e){if(this.$log.debug(e),this.$log.debug(null===e),null!==e){this.$store.dispatch("uiControl/setNodeKey",e);const t=this.$refs.qtree.getNodeByKey(e);this.$store.dispatch("uiControl/setSelectedNodeTitle",t.label)}}},created(){window.addEventListener("beforeunload",(e=>this.beforeunloadFn(e))),this.$bus.$on("btn_click_nextNode",this.btn_click_nextNode)},destroyed(){window.removeEventListener("beforeunload",(e=>this.beforeunloadFn(e))),this.$bus.$off("btn_click_nextNode",this.btn_click_nextNode)},beforeMount(){},mounted(){const e=this.$store.getters["apiSetting/treeUrl"],t=this.$store.getters["apiSetting/treeMethod"];let n=null;switch(t){case"GET":n=this.$axios.get(e);break;case"POST":n=this.$axios.post(e);break;default:n=this.$axios.get(e);break}n.then((e=>(this.$log.debug(`axios response: ${JSON.stringify(e)}`),this.tree.expanded=this.updateExpandedNodeByNodesBfs(this.tree.nodes),this.tree.nodes=e.data,e.data))).then((e=>{this.$log.debug(`expandedNodes: ${this.updateExpandedNodeByNodesBfs(e)}`),this.tree.expanded=this.updateExpandedNodeByNodesBfs(e),this.update_selected(this.$store.getters["uiControl/nodeKey"])})).catch((e=>{this.$q.notify({message:this.$t("connection_fail"),caption:`${e.message}`,type:"negative"})}))}},q=k,C=n("4d5a"),S=n("9404"),E=n("58a81"),T=n("27f9"),B=n("0016"),Q=n("7f41"),D=n("09e3"),O=Object(u["a"])(q,o,r,!1,null,null,null);t["default"]=O.exports;g()(O,"components",{QLayout:C["a"],QDrawer:S["a"],QBadge:E["a"],QInput:T["a"],QIcon:B["a"],QTree:Q["a"],QPageContainer:D["a"]})}}]);